!function t(e,i,n){function r(o,s){if(!i[o]){if(!e[o]){var u="function"==typeof require&&require;if(!s&&u)return u(o,!0);if(a)return a(o,!0);throw new Error("Cannot find module '"+o+"'")}var h=i[o]={exports:{}};e[o][0].call(h.exports,function(t){var i=e[o][1][t];return r(i?i:t)},h,h.exports,t,e,i,n)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();Object.defineProperty(i,"__esModule",{value:!0});var o=t("../../bower_components/hammerjs/hammer.js"),s=n(o),u=function(){function t(){var e=this,i=arguments.length<=0||void 0===arguments[0]?document.body:arguments[0],n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=n.resizable,o=void 0===a?!0:a,s=n.width,u=n.height,h=n.eventListener;return r(this,t),this._pixelRadio=function(){var t=document.createElement("canvas").getContext("2d"),e=window.devicePixelRatio||1,i=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/i}(),this.container=i,this.container.canvas?this.container.canvas:(this.container.canvas=this,this._width=s,this._height=u,this._eventListener=h,this._charts=[],this._currentChartIndex=0,void(!o||s&&u||(window.onresize=function(){return e.resize()})))}return a(t,[{key:"resize",value:function(){var t=this._width||this.container.clientWidth,e=this._height;e||(e=document.documentElement.clientHeight,this.container.style.height=e+"px"),(t!==this.canvasWidth||e!==this.canvasHeight)&&(this.canvasWidth=t,this.canvasHeight=e,this.redraw())}},{key:"initCanvas",value:function(){var t=this._canvas,e=this._ctx;t||(t=this._canvas=document.createElement("canvas"),t.style.position="absolute",t.style.top=0,t.style.left=0,this.container.style.overflow="hidden",this.container.appendChild(t),e=this._ctx=t.getContext("2d"),this.bindEvent());var i=this.container.clientWidth,n=this.container.clientHeight;if(n||(n=document.documentElement.clientHeight,this.container.style.height=n+"px"),0!==i&&0!==n){var r=this.canvasWidth=this._width||i,a=this.canvasHeight=this._height||n,o=this._pixelRadio;t.width=r*o,t.height=a*o,t.style.width=r+"px",t.style.height=a+"px",e.scale(o,o)}}},{key:"redraw",value:function(){this.initCanvas();var t=this.getCurrentChart();t&&t.redraw()}},{key:"getCurrentChart",value:function(){return this._charts[this._currentChartIndex]}},{key:"show",value:function(t){if(t){var e=this._charts.indexOf(t);e>=0?this._currentChartIndex=e:(this._currentChartIndex=this._charts.length,this.addChart(t))}this.redraw()}},{key:"hasChart",value:function(t){return this._charts.indexOf(t)>=0}},{key:"addChart",value:function(t){var e=this._charts.indexOf(t);0>e&&(this._charts.push(t),t.setCanvas(this))}},{key:"removeChart",value:function(t){var e=void 0;e="number"==typeof t?t:this._charts.indexOf(t),e>=0&&(this.clear(),this._currentChartIndex=0,this._charts.splice(e,1))}},{key:"reset",value:function(){this._charts=[],this._currentChartIndex=0,this.clear()}},{key:"clear",value:function(){this._ctx&&this._ctx.clearRect(0,0,this.canvasWidth,this.canvasHeight)}},{key:"bindEvent",value:function(){var t=this,e=new s["default"].Manager(this._canvas,{});e.add(new s["default"].Pan({threshold:10,direction:s["default"].DIRECTION_ALL})),e.add(new s["default"].Press({time:500})),e.add(new s["default"].Pinch);var i=0,n=1,r=!1;e.on("panstart",function(e){i=0,t._eventListener&&t._eventListener(e)}),e.on("panmove panend",function(e){var n=t.getCurrentChart(),a=e.deltaX-i;"panend"===e.type&&(r=!1,a=i=0);var o=n&&n.panMove(r,e.center.x,e.center.y,a);o&&(i+=a),t._eventListener&&t._eventListener(e)}),e.on("press pressup",function(e){r="press"===e.type;var i=t.getCurrentChart();i&&i.panMove(r,e.center.x,e.center.y),t._eventListener&&t._eventListener(e)}),e.on("pinchstart",function(){n=1,t._eventListener&&t._eventListener(event)}),e.on("pinchmove",function(e){if(!r){var i=t.getCurrentChart(),a=i&&i.pinchMove(n-e.scale);a&&(n=e.scale)}t._eventListener&&t._eventListener(e)})}},{key:"toggleMask",value:function(t){var e=this._mask;if(!e){e=this._mask=document.createElement("div"),e["class"]="load-mask";var i=e.style;i.position="absolute",i.top=i.left=i.right=i.bottom=0,i.zIndex=100,i.backgroundColor="rgba(255,255,255,0.5)",this.container.appendChild(e),"|absolute|relative|fix".indexOf(this.container.style.position)<=0&&(this.container.style.position="relative");var n=document.createElement("div"),r=n.style;r.position="absolute",r.marginLeft="-60px",r.top="30%",r.left="50%",r.fontSize="14px",r.textAlign="center",r.padding="4px 8px",r.border="1px solid #333",r.color="#333",n.innerHTML="加载数据中,请稍后",e.appendChild(n)}e.style.display=t?"block":"none"}},{key:"drawLine",value:function(t,e,i,n,r,a){var o=this._ctx;o.beginPath(),o.lineWidth=r,o.strokeStyle=a,o.moveTo(this._normalizeDrawLinePoint(t),this._normalizeDrawLinePoint(e)),o.lineTo(this._normalizeDrawLinePoint(i),this._normalizeDrawLinePoint(n)),o.stroke()}},{key:"drawText",value:function(t,e,i,n,r){var a=arguments.length<=5||void 0===arguments[5]?null:arguments[5],o=this._ctx,s=this.measureText(t);e=Math.min(Math.max(e,0),this.canvasWidth-s),a&&(o.fillStyle=a,o.fillRect(e-2,i+2,s+4,-(n+4))),o.font=n+"px Arial",o.fillStyle=r,o.fillText(t,e,i)}},{key:"fillPath",value:function(t,e,i,n){var r=arguments.length<=4||void 0===arguments[4]?1:arguments[4],a=this._ctx;a.beginPath(),t.forEach(function(t,e){0===e?a.moveTo(t[0],t[1]):a.lineTo(t[0],t[1])}),a.lineWidth=r,a.strokeStyle=i,a.lineJoin="round",a.stroke(),t.length>1?(a.lineWidth=0,a.lineTo(t[t.length-1][0],e),a.lineTo(t[0][0],e),a.closePath(),a.fillStyle=n,a.fill()):a.closePath()}},{key:"drawPath",value:function(t,e){var i=arguments.length<=2||void 0===arguments[2]?1:arguments[2],n=this._ctx;n.beginPath(),t.forEach(function(t,e){0===e?n.moveTo(t[0],t[1]):n.lineTo(t[0],t[1])}),n.lineWidth=i,n.strokeStyle=e,n.lineJoin="round",n.stroke(),n.closePath()}},{key:"drawRect",value:function(t,e,i,n,r){var a=this._ctx;a.fillStyle=r,a.fillRect(t,e,i,n)}},{key:"drawCircle",value:function(t,e,i,n){var r=arguments.length<=4||void 0===arguments[4]?0:arguments[4],a=arguments[5],o=this._ctx;o.beginPath(),o.arc(t,e,i,0,2*Math.PI),o.closePath(),o.fillStyle=n,o.lineWidth=r,o.strokeStyle=a,o.fill()}},{key:"_normalizeDrawLinePoint",value:function(t){if(1===this._pixelRadio){var e=parseInt(t);return e>t?e-.5:e+.5}return t}},{key:"measureText",value:function(t){return this._ctx.measureText(t).width}}]),t}();i["default"]=u},{"../../bower_components/hammerjs/hammer.js":7}],2:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];n(this,t),this.dataProvider=e,this._options=i}return r(t,null,[{key:"formatNumber",value:function(t,e,i,n){null==t&&(t=0);var r=Number(t);if((0===r||isNaN(r))&&n!==!1)return n||"--";switch(i=i||"",e=null!=e?e:2,"K/M"===i&&(i=r>=1e7?"M":r>=1e4?"K":""),i){case"%":r=100*r;break;case"K":r/=1e3;break;case"M":r/=1e6;break;case 100:r/=100,i=""}return r.toFixed(e)+i}},{key:"formatDate",value:function(t,e){var i=void 0,n=void 0,r=void 0;r={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()},/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(n in r)i=r[n],new RegExp("("+n+")").test(e)&&(e=e.replace(RegExp.$1,1===RegExp.$1.length?i:("00"+i).substr((""+i).length)));return e}}]),r(t,[{key:"initData",value:function(){this.hasVolume=this._options.hasVolume||!0,this.fontSize=this._options.fontSize||10,this.upColor=this._options.upColor||"red",this.downColor=this._options.downColor||"green",this.timeAxisHeight=this.fontSize+4,this.separatorWidth=1,this.gridLineWidth=.5,this.gridLineColor="#ddd",this.tickColor="#555",this.tickBackgroundColor="#eee",this.pointerLineColor="#999"}},{key:"setCanvas",value:function(t){this.canvas||(this.canvas=t,this.initData())}},{key:"show",value:function(){this.canvas&&this.canvas.show(this)}},{key:"remove",value:function(){this.canvas&&this.canvas.remove(this)}},{key:"redraw",value:function(){this.canvas&&this.canvas.getCurrentChart()===this&&this.canvas.canvasWidth&&this.canvas.canvasHeight&&(this.canvas.clear(),this.initChart(),this.drawBackground(),this.drawChart(),this.drawAxisTicks(),this.canvas&&this.canvas.toggleMask(!1))}},{key:"initChart",value:function(){this._yAxisTicks=[];var t=this.timeAxisHeight,e=this.hasVolume,i=this.canvas.canvasHeight-t;e?(this.mainChartHeight=.7*i,this.volumeChartHeight=.3*i):(this.mainChartHeight=i,this.volumeChartHeight=0)}},{key:"drawBackground",value:function(){console.warn("not implemented")}},{key:"drawChart",value:function(){console.warn("not implemented")}},{key:"drawAxisTicks",value:function(){var t=this,e=this._yAxisTicks;e&&!function(){var i=t.canvas,n=t.fontSize,r=t.tickBackgroundColor;e.forEach(function(t){i.drawText(t.text,t.x,t.y,n,t.tickColor,t.withBackground&&r)})}()}},{key:"formatYAxisLabel",value:function(e){return t.formatNumber(e,2,"K/M",!1)}},{key:"formatXAxisLabel",value:function(t){return t}},{key:"getColor",value:function(t){return t?this.upColor:this.downColor}},{key:"drawYAxisGridLine",value:function(t,e){var i=arguments.length<=2||void 0===arguments[2]?this.gridLineColor:arguments[2],n=arguments.length<=3||void 0===arguments[3]?"top":arguments[3],r=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],a=arguments.length<=5||void 0===arguments[5]?this.tickColor:arguments[5];if(this.canvas.drawLine(0,t,this.canvas.canvasWidth,t,this.gridLineWidth,i),e){var o=this._yAxisTicks;o.push({text:this.formatYAxisLabel(e),x:0,y:"top"===n?t-2:t+this.fontSize+2,tickColor:a,withBackground:r})}}},{key:"drawXAxisGridLine",value:function(t,e){var i=arguments.length<=2||void 0===arguments[2]?this.gridLineColor:arguments[2],n=arguments.length<=3||void 0===arguments[3]?"middle":arguments[3],r=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],a=arguments.length<=5||void 0===arguments[5]?!1:arguments[5],o=arguments.length<=6||void 0===arguments[6]?this.tickColor:arguments[6];if(this.canvas.drawLine(t,0,t,a?this.canvas.canvasHeight:this.mainChartHeight,this.gridLineWidth,i),e){var s=this.canvas.measureText(e),u=this.fontSize,h="middle"===n?t-s/2:t,c=this.mainChartHeight+u+2;this.canvas.drawText(e,h,c,u,o,r&&this.tickBackgroundColor)}}},{key:"panMove",value:function(t,e,i,n){}},{key:"pinchMove",value:function(t){}}]),t}();i["default"]=a},{}],3:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(u){r=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw a}}return i}return function(e,i){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();Object.defineProperty(i,"__esModule",{value:!0});var u=t("connection"),h=n(u),c=void 0,l={_MIN_DATA_KEY:"MIN_DATA_KEY",get:function(t){try{return JSON.parse(localStorage.getItem(t))}catch(e){return null}},set:function(t,e){localStorage.setItem(t,JSON.stringify(e))},getMin:function(t){return(this.get(this._MIN_DATA_KEY)||[]).find(function(e){return e.obj===t})},setMin:function(t,e){e.obj=t;var i=this.get(this._MIN_DATA_KEY)||[],n=i.findIndex(function(e){return e.obj===t});n>=0?i.splice(n,1,e):(i.push(e),i=i.slice(0,10)),this.set(this._MIN_DATA_KEY,i)}},f=6e4,d=1440*f,p=function(){var t=new Date,e=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2),r=[e,i,n].join("");return{RiQi:r,JiaoYiShiJianDuan:[{KaiShiShiJian:"0930",JieShuShiJian:"1130",KaiShiRiQi:r,JieShuRiQi:r},{KaiShiShiJian:"1300",JieShuShiJian:"1500",KaiShiRiQi:r,JieShuRiQi:r}],JiHeJingJiaDianShu:15,ShiQu:8,ZuoShou:0}}(),v=function(t,e){t+="";var i=parseInt(t.substr(0,4)),n=parseInt(t.substr(4,2))-1,r=parseInt(t.substr(6,2)),a=parseInt(e/100),o=e%100;return new Date(i,n,r,a,o)},g=function(t,e){return v(t,e).getTime()},m=function(){function t(e){r(this,t),this.params=e,this._requests={},t._instances.push(this)}return s(t,null,[{key:"convertToJsonArray",value:function(e){if(!e||!e.head)return e;var i=e.head,n=e.data;return n.map(function(e){var n={};return e.forEach(function(e,r){n[i[r]]=t.convertToJsonArray(e)}),n})}},{key:"arrayBufferToString",value:function(t){var e=new Uint8Array(t),i=e.length;if(i>65535){var n=0,r=[];do{var a=e.subarray(n,n+=65535);r.push(String.fromCharCode.apply(null,a))}while(i>n);return decodeURIComponent(escape(r.join("")))}return decodeURIComponent(escape(String.fromCharCode.apply(null,e)))}}]),s(t,[{key:"_getRequestUrl",value:function(t,e,i,n){var r=o({qid:i,sub:n,output:"json"},e),a=Object.keys(r),s=a.map(function(t){return[t,r[t]].join("=")}).join("&");return t+"?"+s}},{key:"request",value:function e(i,n){var r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],a=arguments[3],o=t._currentQid++,s=this._getRequestUrl(i,n,o,r?1:0),e={qid:o,message:s,subscribe:r,callback:a,cancel:this.cancel.bind(this,o)};return this._requests[o]=e,this.send(s),e}},{key:"send",value:function(t){c.request(t)}},{key:"cancel",value:function(t){this.send("/cancel?qid="+t)}},{key:"getKline",value:function(t,e){var i=this,n=arguments.length<=2||void 0===arguments[2]?!0:arguments[2],r=new Promise(function(n,r){i.request("/quote/kline",o({},i.params,{start:t,count:e}),!1,function(t){t instanceof Error?r(t):n(t[0]&&t[0].Data)})});return console.log("before"),Promise.resolve(1).then(function(t){return console.log(t)}),Promise.all([Promise.resolve(1),Promise.resolve(2)]).then(function(t){return console.log(t)}),console.log("after"),Promise.all([r,n&&this.getMA(t,e)]).then(function(t){var e=a(t,2),i=e[0],n=e[1];return i&&n&&!function(){var t=0,e=n.length;i.forEach(function(i){for(var r=i.ShiJian;e>t;){var a=n[t],s=a.ShiJian,u=a.JieGuo;if(s>r)break;s===r&&o(i,{MA5:u[0],MA10:u[1],MA20:u[2],MA30:u[3]}),t++}})}(),i})}},{key:"subscribeKline",value:function(t){var e=this;return this.request("/quote/kline",o({},this.params,{start:-1}),!0,function(i){i instanceof Error||!function(){var n=i[0]&&i[0].Data;e.getMA(-1).then(function(e){if(n&&e&&n[0]&&e[0]&&n[0].ShiJian===e[0].ShiJian){var i=e[0].JieGuo;o(n[0],{MA5:i[0],MA10:i[1],MA20:i[2],MA30:i[3]})}t(n)})}()})}},{key:"getMA",value:function(t,e){var i=this;return new Promise(function(n,r){i.request("/indicator/calc",o({name:"MA",parameter:"5,10,20,30"},i.params,{start:t,count:e}),!1,function(t){t instanceof Error?r(t):n(t[0]&&t[0].ShuJu)})})}},{key:"_initMinCache",value:function(t){var e=t.JiaoYiShiJianDuan;this.minCache={lastClose:t.ZuoShou};var i=this.minCache.minTimes=[];e&&e.length>0&&!function(){var n=0,r=void 0,a=void 0;e.forEach(function(t,e){for(r=g(t.KaiShiRiQi,t.KaiShiShiJian),a=g(t.JieShuRiQi,t.JieShuShiJian),r>a&&(a+=d),n>r&&(r+=d,a+=d),e>0&&(r+=f);a>=r;)i.push(r),r+=f;n=a});var o=t.JiHeJingJiaDianShu||0;r=i[0];for(var s=1;o>=s;s++)i.unshift(r-s*f)}()}},{key:"_updateMinCache",value:function(t,e){var i=this.minCache.minTimes||[],n=this.minCache.minTimes.indexOf(t);if(n>=0)this.minCache[t]=e;else{var r=i[0],a=parseInt((t-r)/d),o=a*d;if(n=i.indexOf(t-o),n>=0){for(;n<i.length;){var s=i[n];s+=o,i[n]=s,n++}this.minCache[t]=e}}}},{key:"subscribeMin",value:function(t){var e=this;this.minCache=null;var i=l.getMin(this.params.obj);return i&&setTimeout(function(){return t(i)}),this.request("/quote/min",o({},this.params),!0,function(i){i&&!(i instanceof Error)&&i.length>0&&(i=i[0],1===i.QingPan&&(e.minCache=null),e.minCache||e._initMinCache(i.JiaoYiShiJianDuan?i:p),i=i.Data,i&&i.length>0&&i.forEach(function(t){var i=1e3*t.ShiJian;e._updateMinCache(i,t)}),t(e.minCache),l.setMin(e.params.obj,e.minCache))})}}],[{key:"formatData",value:function(e){return e.JsonTbl?(e=t.convertToJsonArray(e.JsonTbl)[0],e[Object.keys(e)[0]]):e.hasOwnProperty("Id")?(delete e.Id,delete e.Obj,e[Object.keys(e)[0]]):e}}]),t}();m._instances=[],m._currentQid=0,i["default"]=m,m.init=function(t,e){e&&t.indexOf("token")<0&&(t=[t,e].join("?token=")),c=(0,h["default"])(t,{},{message:function(t){if(t instanceof ArrayBuffer)try{t=m.arrayBufferToString(t)}catch(e){console.error(e)}if("string"==typeof t)try{!function(){var e=JSON.parse(t),i=e.Qid,n=e.Err,r=void 0===n?0:n,a=e.Data;i&&m._instances.some(function(t){var e=t._requests[i];return e?(e.callback(0===r?m.formatData(a):new Error(JSON.stringify(a))),!0):void 0})}()}catch(e){console.error(e)}}})}},{connection:8}],4:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function f(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:f(r,e,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)};Object.defineProperty(i,"__esModule",{value:!0});var h=t("./Chart.js"),c=n(h),l=function(t){function e(){return r(this,e),a(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),s(e,[{key:"initData",value:function(){var t=this;u(Object.getPrototypeOf(e.prototype),"initData",this).call(this),this.data=this._options.data||[],this.cache=[].concat(this.data),this.maxCount=this._options.maxCount||Number.MAX_VALUE,this.minCount=this._options.minCount||10,this.maxPreLoadCount=this._options.maxPreLoadCount||200,this.position=0,this.hasMoreData=!0,this.reCalculate(0,this._options.initCount||80);var i=this.dataProvider.subscribeKline(function(e){return t.canvas.hasChart(t)?void(e.length>0&&(e=e[0],t.cache.length>0&&(t.cache[t.cache.length-1]=e),t.reCalculate())):void i.cancel()})}},{key:"redraw",value:function(){this.data.length>0&&u(Object.getPrototypeOf(e.prototype),"redraw",this).call(this)}},{key:"initChart",value:function(){u(Object.getPrototypeOf(e.prototype),"initChart",this).call(this);var t=this.data.length,i=this.separatorWidth,n=this.canvas.canvasWidth/t-i;1>n&&(t=parseInt(this.canvas.canvasWidth/(1+i)),this.data=this.data.slice(0,t),n=1,this.maxCount=t),this.pixelPer=n,this.pixelPerWithSeparator=n+i;var r=Number.MAX_VALUE,a=Number.MIN_VALUE,o=r,s=0,h=0;this.data.forEach(function(t){s=Math.max(s,t.ZuiGaoJia||a,t.MA5||a,t.MA10||a,t.MA20||a,t.MA30||a),o=Math.min(o,t.ZuiDiJia||r,t.MA5||r,t.MA10||r,t.MA20||r,t.MA30||r),h=Math.max(h,t.ChengJiaoLiang)}),this.max=s>o?s+.1*(s-o):1.1*s,this.min=s>o?o-.1*(s-o):.9*s,this.maxVolume=h,this.candleChartHeight=this.mainChartHeight,this.candleYPixelRadio=this.candleChartHeight/(this.max-this.min),this.volumeYPixelRadio=this.volumeChartHeight/h}},{key:"formatXAxisLabel",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],i=new Date(t);return e?c["default"].formatDate(i,"yyyy-MM-dd"):c["default"].formatDate(i,"yyyy-MM")}},{key:"isUp",value:function(t,e,i){return t!==e?e>t:e>i}},{key:"drawChart",value:function(){var t=this,e=void 0,i=void 0,n=0,r=[[],[],[],[]];this.data.forEach(function(a,o){var s=a.lastClose;if(s||(s=a.lastClose=o>0?t.data[o-1].ShouPanJia:0,a.time=1e3*a.ShiJian,a.isUp=t.isUp(a.KaiPanJia,a.ShouPanJia,s),a.xAxisLabel=t.formatXAxisLabel(a.time)),i=a.xAxisLabel,i!==e&&(e=i,(o-n)*t.pixelPerWithSeparator>50&&(t.drawXAxisGridLine(t.pixelPerWithSeparator*o+t.pixelPer/2,i),n=o)),t.drawCandle(o,a.KaiPanJia,a.ShouPanJia,a.ZuiGaoJia,a.ZuiDiJia,a.isUp),t.hasVolume&&t.drawVolume(o,a.ChengJiaoLiang,a.isUp),a.MA5){var u=t.pixelPerWithSeparator*o+t.pixelPer/2;0===o?u-=t.pixelPer/2:o===t.data.length-1&&(u+=t.pixelPer/2),r[0].push([u,t.candleYPixelRadio*(t.max-a.MA5)]),r[1].push([u,t.candleYPixelRadio*(t.max-a.MA10)]),r[2].push([u,t.candleYPixelRadio*(t.max-a.MA20)]),r[3].push([u,t.candleYPixelRadio*(t.max-a.MA30)])}});var a=["#FFD11E","#F77BFC","#39C2FD","#B7B7B7"];if(r.forEach(function(e,i){t.canvas.drawPath(e,a[i])}),this.pressPoint){var o=this.pressPoint,s=o.x,u=o.y,h=parseInt(s/this.pixelPerWithSeparator),c=this.data[h]||{};this.drawXAxisGridLine(this.pixelPerWithSeparator*h+this.pixelPer/2,this.formatXAxisLabel(c.time,!0),this.pointerLineColor,void 0,!0,!0),u<this.candleChartHeight&&u>0&&this.drawYAxisGridLine(u,this.max-u/this.candleYPixelRadio,this.pointerLineColor,u>this.candleChartHeight/2?"top":"bottom",!0),this.drawTooltip(c)}}},{key:"drawTooltip",value:function(t){var e=this,i=50,n=this.fontSize,r=n+2,a=this.getColor(this.isUp(t.KaiPanJia,t.ShouPanJia,t.lastClose));[{label:"日期:"+this.formatXAxisLabel(t.time,!0),labelColor:"#555"},{label:"开:"+c["default"].formatNumber(t.KaiPanJia,2)},{label:"收:"+c["default"].formatNumber(t.ShouPanJia,2)},{label:"高:"+c["default"].formatNumber(t.ZuiGaoJia,2)},{label:"低:"+c["default"].formatNumber(t.ZuiDiJia,2)},{label:"涨跌:"+c["default"].formatNumber((t.ShouPanJia-t.lastClose)/t.lastClose,2,"%"),labelColor:this.getColor(t.ShouPanJia>=t.lastClose)},{label:"量:"+c["default"].formatNumber(t.ChengJiaoLiang,2,"K/M")}].forEach(function(t){var o=t.label,s=t.labelColor,u=void 0===s?a:s;e.canvas.drawText(o,i,r,n,u),i+=e.canvas.measureText(o)+10})}},{key:"drawBackground",value:function(){var t=this.max,e=this.min;this.drawYAxisGridLine(0,t,null,"bottom"),this.drawYAxisGridLine(this.candleChartHeight,e),this.drawYAxisGridLine(this.candleChartHeight/2,t-(t-e)/2),this.drawYAxisGridLine(this.candleChartHeight/4,t-(t-e)/4),this.drawYAxisGridLine(3*this.candleChartHeight/4,t-3*(t-e)/4),this.drawYAxisGridLine(this.canvas.canvasHeight,"0"),this.drawYAxisGridLine(this.canvas.canvasHeight-this.volumeChartHeight,this.maxVolume,null,"bottom")}},{key:"drawCandle",value:function(t,e,i,n,r,a){var o=this.pixelPerWithSeparator*t,s=this.candleYPixelRadio*(this.max-e),u=this.pixelPer,h=e===i?1:this.candleYPixelRadio*(this.max-i)-s;h=Math.abs(h)<1?Math.sign(h):h;var c=this.getColor(a);u>1&&this.canvas.drawRect(o,s,u,h,c);var l=o+u/2,f=this.candleYPixelRadio*(this.max-n),d=this.candleYPixelRadio*(this.max-r);this.canvas.drawLine(l,f,l,d,1,c)}},{key:"drawVolume",value:function(t,e,i){var n=this.pixelPerWithSeparator*t,r=this.canvas.canvasHeight,a=this.pixelPer,o=-this.volumeYPixelRadio*e;this.canvas.drawRect(n,r,a,o,this.getColor(i))}},{key:"reCalculate",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]?0:arguments[0],i=arguments[1],n=0,r=this.data.length,a=this.cache.length,o=this.position;if(e>0)e>o?this.hasMoreData?n=e-o:o=0:o-=e;else if(0>e){var s=a-o-r;o+=s>-e?-e:s}if(i&&(i=Math.max(i,this.minCount)),r>i)o+=parseInt((r-i)/2),r=i;else if(i>r){i=Math.min(i,this.maxCount);var u=parseInt((i-r)/2);u+=Math.max(u-(a-o-r),0),u>o&&this.hasMoreData?n=u-o:(o=Math.max(o-u,0),r=i)}if(n>0){n+=Math.min(r||Number.MAX_VALUE,this.maxPreLoadCount);var h=-(n+a);return void this.loadMoreData(h,n).then(function(){t.reCalculate(e,i)})}this.data=this.cache.slice(o,o+r),this.position=o,this.redraw()}},{key:"loadMoreData",value:function(t,e){var i=this;this._loading=!0,this.canvas&&this.canvas.toggleMask(!0);var n=this.dataProvider;return this.dataProvider.getKline(t,e).then(function(t){if(t&&n===i.dataProvider){t.length<e&&(i.hasMoreData=!1);for(var r=i.cache[0]?i.cache[0].ShiJian:Number.MAX_VALUE,a=void 0,o=t.length;o>0;o--){if(a=t[o-1],!(a.ShiJian<r)){i.hasMoreData=!1;break}i.cache.unshift(a),i.position++}}i._loading=!1})}},{key:"panMove",value:function(t,e,i,n){if(!this._loading)if(t)this.pressPoint={x:e,y:i},this.redraw();else if(this.pressPoint)this.pressPoint=null,this.redraw();else{var r=parseInt(n/this.pixelPerWithSeparator);if(0!==r)return this.reCalculate(r),!0}}},{key:"pinchMove",value:function(t){if(!this._loading){var e=this.canvas.canvasWidth*t,i=parseInt(e/this.pixelPerWithSeparator);if(Math.abs(i)>1)return this.reCalculate(0,this.data.length+i),!0}}}]),e}(c["default"]);i["default"]=l},{"./Chart.js":2}],5:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=function f(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var r=Object.getPrototypeOf(t);return null===r?void 0:f(r,e,i)}if("value"in n)return n.value;var a=n.get;if(void 0!==a)return a.call(i)};Object.defineProperty(i,"__esModule",{value:!0});var h=t("./Chart.js"),c=n(h),l=function(t){function e(){return r(this,e),a(this,Object.getPrototypeOf(e).apply(this,arguments))}return o(e,t),s(e,[{key:"initData",value:function(){var t=this;u(Object.getPrototypeOf(e.prototype),"initData",this).call(this),this.cache=null,this.canvas&&this.canvas.toggleMask(!0);var i=this.dataProvider.subscribeMin(function(e){return t.canvas.hasChart(t)?(t.cache=e,void t.redraw()):void i.cancel()})}},{key:"initChart",value:function(){u(Object.getPrototypeOf(e.prototype),"initChart",this).call(this);var t=this.cache.lastClose,i=Number.MAX_VALUE,n=Number.MIN_VALUE,r=i,a=0,o=0;if(t){var s=0,h=void 0;for(var c in this.cache)h=this.cache[c],h&&h.ChengJiaoJia&&(s=Math.max(s,Math.abs(h.ChengJiaoJia-t)),o=Math.max(o,h.ChengJiaoLiang));a=t+s,r=t-s}else{var h=void 0;for(var c in this.cache)h=this.cache[c],h&&h.ChengJiaoJia&&(a=Math.max(a,h.ChengJiaoJia||n),r=Math.min(r,h.ChengJiaoJia||i),o=Math.max(o,h.ChengJiaoLiang))}this.max=a>r?a+.1*(a-r):1.1*a,this.min=a>r?r-.1*(a-r):.9*a,this.maxVolume=o,this.minChartHeight=this.mainChartHeight,this.minYPixelRadio=this.minChartHeight/(this.max-this.min),this.volumeYPixelRadio=this.volumeChartHeight/o,this.pixelPer=this.canvas.canvasWidth/this.cache.minTimes.length}},{key:"formatXAxisLabel",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],i=new Date(t);return e?c["default"].formatDate(i,"yyyy-MM-dd hh:mm"):c["default"].formatDate(i,"hh:mm")}},{key:"redraw",value:function(){this.cache&&u(Object.getPrototypeOf(e.prototype),"redraw",this).call(this)}},{key:"drawChart",value:function(){var t=this,e=this.cache.minTimes,i=this.pixelPer,n=[],r=[],a=this.cache.lastClose,o=e.length>300?60:30,s=-100;if(e.forEach(function(u,h){var c=t.cache[u];if(c){var l=c.isUp=c.ChengJiaoJia>=a,f=i*h,d=f+i/2;c.ChengJiaoJia&&n.push([d,(t.max-c.ChengJiaoJia)*t.minYPixelRadio]),c.JunJia&&r.push([d,(t.max-c.JunJia)*t.minYPixelRadio]),t.hasVolume&&t.drawVolume(h,c.ChengJiaoLiang,l),a=c.ChengJiaoJia}var p=void 0;h>0&&u-e[h-1]>6e4&&s!==h-1?p=h-1:new Date(u).getMinutes()%o===0&&(p=h),p&&(p-s)*i>50&&(t.drawXAxisGridLine(i*p+i/2,t.formatXAxisLabel(e[p]),"#ddd"),s=p)}),this.canvas.fillPath(n,this.minChartHeight,"#0095D9","rgba(0, 149, 217, 0.2)"),this.canvas.drawPath(r,"#EB5F15"),this.pressPoint){var u=this.pressPoint,h=u.x,c=u.y,l=parseInt(h/i),f=e[l],d=this.cache[f];if(d){h=i*l+i/2,this.drawXAxisGridLine(i*l+i/2,this.formatXAxisLabel(f),this.pointerLineColor,void 0,!0,!0);var p=d.ChengJiaoJia;c=(this.max-p)*this.minYPixelRadio,this.drawYAxisGridLine(c,p,this.pointerLineColor,c>this.minChartHeight/2?"top":"bottom",!0,this.getColor(d.ChengJiaoJia>=this.cache.lastClose)),this.canvas.drawCircle(h,c,3,"rgba(230, 100, 100, 0.8)"),this.drawTooltip(d)}}}},{key:"drawVolume",value:function(t,e,i){var n=this.pixelPer*t,r=this.canvas.canvasHeight,a=this.pixelPer;a-=a>2?1:.5;var o=-this.volumeYPixelRadio*e;this.canvas.drawRect(n,r,a,o,this.getColor(i))}},{key:"drawTooltip",value:function(t){var e=this,i=50,n=this.fontSize,r=n+2,a=this.cache.lastClose;[{label:"时间:"+this.formatXAxisLabel(1e3*t.ShiJian),labelColor:"#555"},{label:"价格:"+c["default"].formatNumber(t.ChengJiaoJia,2),labelColor:"#0095D9"},t.JunJia<=this.max&&t.JunJia>=this.min?{label:"均价:"+c["default"].formatNumber(t.JunJia,2),labelColor:"#EB5F15"}:void 0,{label:"涨跌:"+c["default"].formatNumber((t.ChengJiaoJia-a)/a,2,"%"),labelColor:this.getColor(t.ChengJiaoJia>=a)},{label:"成交量:"+c["default"].formatNumber(t.ChengJiaoLiang,2,"K/M"),labelColor:this.getColor(t.isUp)}].forEach(function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],a=t.label,o=t.labelColor;a&&(e.canvas.drawText(a,i,r,n,o),i+=e.canvas.measureText(a)+10)})}},{key:"drawBackground",value:function(){var t=this.cache.ZuoShou,i=this.max,n=this.min;this.drawYAxisGridLine(0,i,void 0,"bottom",void 0,this.getColor(!0)),this.drawYAxisGridLine(this.minChartHeight,n,void 0,void 0,void 0,this.getColor(!1)),this.drawYAxisGridLine(this.minChartHeight/2,t||i-(i-n)/2),this.drawYAxisGridLine(this.minChartHeight/4,i-(i-n)/4,void 0,void 0,void 0,this.getColor(!0)),this.drawYAxisGridLine(3*this.minChartHeight/4,i-3*(i-n)/4,void 0,void 0,void 0,this.getColor(!1)),u(Object.getPrototypeOf(e.prototype),"drawYAxisGridLine",this).call(this,this.canvas.canvasHeight,"0"),u(Object.getPrototypeOf(e.prototype),"drawYAxisGridLine",this).call(this,this.canvas.canvasHeight-this.volumeChartHeight,this.maxVolume,null,"bottom")}},{key:"drawYAxisGridLine",value:function(t,i){var n=arguments.length<=2||void 0===arguments[2]?this.gridLineColor:arguments[2],r=arguments.length<=3||void 0===arguments[3]?"top":arguments[3],a=arguments.length<=4||void 0===arguments[4]?!1:arguments[4],o=arguments.length<=5||void 0===arguments[5]?this.tickColor:arguments[5];if(u(Object.getPrototypeOf(e.prototype),"drawYAxisGridLine",this).call(this,t,i,n,r,a,o),i){var s=this._yAxisTicks,h=c["default"].formatNumber((i-this.cache.lastClose)/this.cache.lastClose,2,"%",!1);
s.push({text:h,x:this.canvas.canvasWidth-this.canvas.measureText(h)-2,y:"top"===r?t-2:t+this.fontSize+2,tickColor:o,withBackground:a})}}},{key:"panMove",value:function(t,e,i){t?this.pressPoint={x:e,y:i}:this.pressPoint=null,this.redraw()}}]),e}(c["default"]);i["default"]=l},{"./Chart.js":2}],6:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}var r=t("./Canvas.js"),a=n(r),o=t("./KlineChart.js"),s=n(o),u=t("./MinChart.js"),h=n(u),c=t("./DataProvider.js"),l=n(c);window.Canvas=a["default"],window.KlineChart=s["default"],window.MinChart=h["default"],window.DataProvider=l["default"]},{"./Canvas.js":1,"./DataProvider.js":3,"./KlineChart.js":4,"./MinChart.js":5}],7:[function(t,e,i){!function(t,i,n,r){"use strict";function a(t,e,i){return setTimeout(c(t,i),e)}function o(t,e,i){return Array.isArray(t)?(s(t,i[e],i),!0):!1}function s(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==r)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function u(e,i,n){var r="DEPRECATED METHOD: "+i+"\n"+n+" AT \n";return function(){var i=new Error("get-stack-trace"),n=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=t.console&&(t.console.warn||t.console.log);return a&&a.call(t.console,r,n),e.apply(this,arguments)}}function h(t,e,i){var n,r=e.prototype;n=t.prototype=Object.create(r),n.constructor=t,n._super=r,i&&ut(n,i)}function c(t,e){return function(){return t.apply(e,arguments)}}function l(t,e){return typeof t==lt?t.apply(e?e[0]||r:r,e):t}function f(t,e){return t===r?e:t}function d(t,e,i){s(m(e),function(e){t.addEventListener(e,i,!1)})}function p(t,e,i){s(m(e),function(e){t.removeEventListener(e,i,!1)})}function v(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function g(t,e){return t.indexOf(e)>-1}function m(t){return t.trim().split(/\s+/g)}function y(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function b(t){return Array.prototype.slice.call(t,0)}function x(t,e,i){for(var n=[],r=[],a=0;a<t.length;){var o=e?t[a][e]:t[a];y(r,o)<0&&n.push(t[a]),r[a]=o,a++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function w(t,e){for(var i,n,a=e[0].toUpperCase()+e.slice(1),o=0;o<ht.length;){if(i=ht[o],n=i?i+a:e,n in t)return n;o++}return r}function C(){return mt++}function _(e){var i=e.ownerDocument||e;return i.defaultView||i.parentWindow||t}function E(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){l(t.options.enable,[t])&&i.handler(e)},this.init()}function T(t){var e,i=t.options.inputClass;return new(e=i?i:xt?H:wt?W:bt?X:I)(t,P)}function P(t,e,i){var n=i.pointers.length,r=i.changedPointers.length,a=e&St&&n-r===0,o=e&(Mt|At)&&n-r===0;i.isFirst=!!a,i.isFinal=!!o,a&&(t.session={}),i.eventType=e,S(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function S(t,e){var i=t.session,n=e.pointers,r=n.length;i.firstInput||(i.firstInput=A(e)),r>1&&!i.firstMultiple?i.firstMultiple=A(e):1===r&&(i.firstMultiple=!1);var a=i.firstInput,o=i.firstMultiple,s=o?o.center:a.center,u=e.center=O(n);e.timeStamp=pt(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=D(s,u),e.distance=R(s,u),k(i,e),e.offsetDirection=j(e.deltaX,e.deltaY);var h=L(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=h.x,e.overallVelocityY=h.y,e.overallVelocity=dt(h.x)>dt(h.y)?h.x:h.y,e.scale=o?N(o.pointers,n):1,e.rotation=o?J(o.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,M(i,e);var c=t.element;v(e.srcEvent.target,c)&&(c=e.srcEvent.target),e.target=c}function k(t,e){var i=e.center,n=t.offsetDelta||{},r=t.prevDelta||{},a=t.prevInput||{};(e.eventType===St||a.eventType===Mt)&&(r=t.prevDelta={x:a.deltaX||0,y:a.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=r.x+(i.x-n.x),e.deltaY=r.y+(i.y-n.y)}function M(t,e){var i,n,a,o,s=t.lastInterval||e,u=e.timeStamp-s.timeStamp;if(e.eventType!=At&&(u>Pt||s.velocity===r)){var h=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,l=L(u,h,c);n=l.x,a=l.y,i=dt(l.x)>dt(l.y)?l.x:l.y,o=j(h,c),t.lastInterval=e}else i=s.velocity,n=s.velocityX,a=s.velocityY,o=s.direction;e.velocity=i,e.velocityX=n,e.velocityY=a,e.direction=o}function A(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:ft(t.pointers[i].clientX),clientY:ft(t.pointers[i].clientY)},i++;return{timeStamp:pt(),pointers:e,center:O(e),deltaX:t.deltaX,deltaY:t.deltaY}}function O(t){var e=t.length;if(1===e)return{x:ft(t[0].clientX),y:ft(t[0].clientY)};for(var i=0,n=0,r=0;e>r;)i+=t[r].clientX,n+=t[r].clientY,r++;return{x:ft(i/e),y:ft(n/e)}}function L(t,e,i){return{x:e/t||0,y:i/t||0}}function j(t,e){return t===e?Ot:dt(t)>=dt(e)?0>t?Lt:jt:0>e?Rt:Dt}function R(t,e,i){i||(i=Ht);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return Math.sqrt(n*n+r*r)}function D(t,e,i){i||(i=Ht);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return 180*Math.atan2(r,n)/Math.PI}function J(t,e){return D(e[1],e[0],Yt)+D(t[1],t[0],Yt)}function N(t,e){return R(e[0],e[1],Yt)/R(t[0],t[1],Yt)}function I(){this.evEl=Wt,this.evWin=Vt,this.allow=!0,this.pressed=!1,E.apply(this,arguments)}function H(){this.evEl=Gt,this.evWin=Bt,E.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function Y(){this.evTarget=Ft,this.evWin=Kt,this.started=!1,E.apply(this,arguments)}function q(t,e){var i=b(t.touches),n=b(t.changedTouches);return e&(Mt|At)&&(i=x(i.concat(n),"identifier",!0)),[i,n]}function W(){this.evTarget=Qt,this.targetIds={},E.apply(this,arguments)}function V(t,e){var i=b(t.touches),n=this.targetIds;if(e&(St|kt)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,a,o=b(t.changedTouches),s=[],u=this.target;if(a=i.filter(function(t){return v(t.target,u)}),e===St)for(r=0;r<a.length;)n[a[r].identifier]=!0,r++;for(r=0;r<o.length;)n[o[r].identifier]&&s.push(o[r]),e&(Mt|At)&&delete n[o[r].identifier],r++;return s.length?[x(a.concat(s),"identifier",!0),s]:void 0}function X(){E.apply(this,arguments);var t=c(this.handler,this);this.touch=new W(this.manager,t),this.mouse=new I(this.manager,t)}function z(t,e){this.manager=t,this.set(e)}function G(t){if(g(t,re))return re;var e=g(t,ae),i=g(t,oe);return e&&i?re:e||i?e?ae:oe:g(t,ne)?ne:ie}function B(t){this.options=ut({},this.defaults,t||{}),this.id=C(),this.manager=null,this.options.enable=f(this.options.enable,!0),this.state=se,this.simultaneous={},this.requireFail=[]}function U(t){return t&fe?"cancel":t&ce?"end":t&he?"move":t&ue?"start":""}function F(t){return t==Dt?"down":t==Rt?"up":t==Lt?"left":t==jt?"right":""}function K(t,e){var i=e.manager;return i?i.get(t):t}function $(){B.apply(this,arguments)}function Q(){$.apply(this,arguments),this.pX=null,this.pY=null}function Z(){$.apply(this,arguments)}function tt(){B.apply(this,arguments),this._timer=null,this._input=null}function et(){$.apply(this,arguments)}function it(){$.apply(this,arguments)}function nt(){B.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function rt(t,e){return e=e||{},e.recognizers=f(e.recognizers,rt.defaults.preset),new at(t,e)}function at(t,e){this.options=ut({},rt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=T(this),this.touchAction=new z(this,this.options.touchAction),ot(this,!0),s(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ot(t,e){var i=t.element;i.style&&s(t.options.cssProps,function(t,n){i.style[w(i.style,n)]=e?t:""})}function st(t,e){var n=i.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}var ut,ht=["","webkit","Moz","MS","ms","o"],ct=i.createElement("div"),lt="function",ft=Math.round,dt=Math.abs,pt=Date.now;ut="function"!=typeof Object.assign?function(t){if(t===r||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==r&&null!==n)for(var a in n)n.hasOwnProperty(a)&&(e[a]=n[a])}return e}:Object.assign;var vt=u(function(t,e,i){for(var n=Object.keys(e),a=0;a<n.length;)(!i||i&&t[n[a]]===r)&&(t[n[a]]=e[n[a]]),a++;return t},"extend","Use `assign`."),gt=u(function(t,e){return vt(t,e,!0)},"merge","Use `assign`."),mt=1,yt=/mobile|tablet|ip(ad|hone|od)|android/i,bt="ontouchstart"in t,xt=w(t,"PointerEvent")!==r,wt=bt&&yt.test(navigator.userAgent),Ct="touch",_t="pen",Et="mouse",Tt="kinect",Pt=25,St=1,kt=2,Mt=4,At=8,Ot=1,Lt=2,jt=4,Rt=8,Dt=16,Jt=Lt|jt,Nt=Rt|Dt,It=Jt|Nt,Ht=["x","y"],Yt=["clientX","clientY"];E.prototype={handler:function(){},init:function(){this.evEl&&d(this.element,this.evEl,this.domHandler),this.evTarget&&d(this.target,this.evTarget,this.domHandler),this.evWin&&d(_(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(_(this.element),this.evWin,this.domHandler)}};var qt={mousedown:St,mousemove:kt,mouseup:Mt},Wt="mousedown",Vt="mousemove mouseup";h(I,E,{handler:function(t){var e=qt[t.type];e&St&&0===t.button&&(this.pressed=!0),e&kt&&1!==t.which&&(e=Mt),this.pressed&&this.allow&&(e&Mt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Et,srcEvent:t}))}});var Xt={pointerdown:St,pointermove:kt,pointerup:Mt,pointercancel:At,pointerout:At},zt={2:Ct,3:_t,4:Et,5:Tt},Gt="pointerdown",Bt="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Gt="MSPointerDown",Bt="MSPointerMove MSPointerUp MSPointerCancel"),h(H,E,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),r=Xt[n],a=zt[t.pointerType]||t.pointerType,o=a==Ct,s=y(e,t.pointerId,"pointerId");r&St&&(0===t.button||o)?0>s&&(e.push(t),s=e.length-1):r&(Mt|At)&&(i=!0),0>s||(e[s]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:a,srcEvent:t}),i&&e.splice(s,1))}});var Ut={touchstart:St,touchmove:kt,touchend:Mt,touchcancel:At},Ft="touchstart",Kt="touchstart touchmove touchend touchcancel";h(Y,E,{handler:function(t){var e=Ut[t.type];if(e===St&&(this.started=!0),this.started){var i=q.call(this,t,e);e&(Mt|At)&&i[0].length-i[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Ct,srcEvent:t})}}});var $t={touchstart:St,touchmove:kt,touchend:Mt,touchcancel:At},Qt="touchstart touchmove touchend touchcancel";h(W,E,{handler:function(t){var e=$t[t.type],i=V.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:Ct,srcEvent:t})}}),h(X,E,{handler:function(t,e,i){var n=i.pointerType==Ct,r=i.pointerType==Et;if(n)this.mouse.allow=!1;else if(r&&!this.mouse.allow)return;e&(Mt|At)&&(this.mouse.allow=!0),this.callback(t,e,i)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Zt=w(ct.style,"touchAction"),te=Zt!==r,ee="compute",ie="auto",ne="manipulation",re="none",ae="pan-x",oe="pan-y";z.prototype={set:function(t){t==ee&&(t=this.compute()),te&&this.manager.element.style&&(this.manager.element.style[Zt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return s(this.manager.recognizers,function(e){l(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),G(t.join(" "))},preventDefaults:function(t){if(!te){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var n=this.actions,r=g(n,re),a=g(n,oe),o=g(n,ae);if(r){var s=1===t.pointers.length,u=t.distance<2,h=t.deltaTime<250;if(s&&u&&h)return}if(!o||!a)return r||a&&i&Jt||o&&i&Nt?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var se=1,ue=2,he=4,ce=8,le=ce,fe=16,de=32;B.prototype={defaults:{},set:function(t){return ut(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(o(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=K(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return o(t,"dropRecognizeWith",this)?this:(t=K(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(o(t,"requireFailure",this))return this;var e=this.requireFail;return t=K(t,this),-1===y(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(o(t,"dropRequireFailure",this))return this;t=K(t,this);var e=y(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){i.manager.emit(e,t)}var i=this,n=this.state;ce>n&&e(i.options.event+U(n)),e(i.options.event),t.additionalEvent&&e(t.additionalEvent),n>=ce&&e(i.options.event+U(n))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=de)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(de|se)))return!1;t++}return!0},recognize:function(t){var e=ut({},t);return l(this.options.enable,[this,e])?(this.state&(le|fe|de)&&(this.state=se),this.state=this.process(e),void(this.state&(ue|he|ce|fe)&&this.tryEmit(e))):(this.reset(),void(this.state=de))},process:function(t){},getTouchAction:function(){},reset:function(){}},h($,B,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(ue|he),r=this.attrTest(t);return n&&(i&At||!r)?e|fe:n||r?i&Mt?e|ce:e&ue?e|he:ue:de}}),h(Q,$,{defaults:{event:"pan",threshold:10,pointers:1,direction:It},getTouchAction:function(){var t=this.options.direction,e=[];return t&Jt&&e.push(oe),t&Nt&&e.push(ae),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,r=t.direction,a=t.deltaX,o=t.deltaY;return r&e.direction||(e.direction&Jt?(r=0===a?Ot:0>a?Lt:jt,i=a!=this.pX,n=Math.abs(t.deltaX)):(r=0===o?Ot:0>o?Rt:Dt,i=o!=this.pY,n=Math.abs(t.deltaY))),t.direction=r,i&&n>e.threshold&&r&e.direction},attrTest:function(t){return $.prototype.attrTest.call(this,t)&&(this.state&ue||!(this.state&ue)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=F(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),h(Z,$,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[re]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ue)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),h(tt,B,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ie]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(Mt|At)&&!r)this.reset();else if(t.eventType&St)this.reset(),this._timer=a(function(){this.state=le,this.tryEmit()},e.time,this);else if(t.eventType&Mt)return le;return de},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===le&&(t&&t.eventType&Mt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=pt(),this.manager.emit(this.options.event,this._input)))}}),h(et,$,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[re]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ue)}}),h(it,$,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Jt|Nt,pointers:1},getTouchAction:function(){return Q.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(Jt|Nt)?e=t.overallVelocity:i&Jt?e=t.overallVelocityX:i&Nt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&dt(e)>this.options.velocity&&t.eventType&Mt},emit:function(t){var e=F(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),h(nt,B,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ne]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&St&&0===this.count)return this.failTimeout();if(n&&r&&i){if(t.eventType!=Mt)return this.failTimeout();var o=this.pTime?t.timeStamp-this.pTime<e.interval:!0,s=!this.pCenter||R(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t;var u=this.count%e.taps;if(0===u)return this.hasRequireFailures()?(this._timer=a(function(){this.state=le,this.tryEmit()},e.interval,this),ue):le}return de},failTimeout:function(){return this._timer=a(function(){this.state=de},this.options.interval,this),de},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==le&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),rt.VERSION="2.0.6",rt.defaults={domEvents:!1,touchAction:ee,enable:!0,inputTarget:null,inputClass:null,preset:[[et,{enable:!1}],[Z,{enable:!1},["rotate"]],[it,{direction:Jt}],[Q,{direction:Jt},["swipe"]],[nt],[nt,{event:"doubletap",taps:2},["tap"]],[tt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var pe=1,ve=2;at.prototype={set:function(t){return ut(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?ve:pe},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var i,n=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&le)&&(r=e.curRecognizer=null);for(var a=0;a<n.length;)i=n[a],e.stopped===ve||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(t),!r&&i.state&(ue|he|ce)&&(r=e.curRecognizer=i),a++}},get:function(t){if(t instanceof B)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(o(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(o(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=y(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){var i=this.handlers;return s(m(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this},off:function(t,e){var i=this.handlers;return s(m(t),function(t){e?i[t]&&i[t].splice(y(i[t],e),1):delete i[t]}),this},emit:function(t,e){this.options.domEvents&&st(t,e);var i=this.handlers[t]&&this.handlers[t].slice();if(i&&i.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var n=0;n<i.length;)i[n](e),n++}},destroy:function(){this.element&&ot(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},ut(rt,{INPUT_START:St,INPUT_MOVE:kt,INPUT_END:Mt,INPUT_CANCEL:At,STATE_POSSIBLE:se,STATE_BEGAN:ue,STATE_CHANGED:he,STATE_ENDED:ce,STATE_RECOGNIZED:le,STATE_CANCELLED:fe,STATE_FAILED:de,DIRECTION_NONE:Ot,DIRECTION_LEFT:Lt,DIRECTION_RIGHT:jt,DIRECTION_UP:Rt,DIRECTION_DOWN:Dt,DIRECTION_HORIZONTAL:Jt,DIRECTION_VERTICAL:Nt,DIRECTION_ALL:It,Manager:at,Input:E,TouchAction:z,TouchInput:W,MouseInput:I,PointerEventInput:H,TouchMouseInput:X,SingleTouchInput:Y,Recognizer:B,AttrRecognizer:$,Tap:nt,Pan:Q,Swipe:it,Pinch:Z,Rotate:et,Press:tt,on:d,off:p,each:s,merge:gt,extend:vt,assign:ut,inherit:h,bindFn:c,prefixed:w});var ge="undefined"!=typeof t?t:"undefined"!=typeof self?self:{};ge.Hammer=rt,"function"==typeof define&&define.amd?define(function(){return rt}):"undefined"!=typeof e&&e.exports?e.exports=rt:t[n]=rt}(window,document,"Hammer")},{}],8:[function(t,e,i){t("./lib/HttpConnection"),t("./lib/WebSocketConnection"),e.exports=t("./lib/connection")},{"./lib/HttpConnection":10,"./lib/WebSocketConnection":12,"./lib/connection":15}],9:[function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(e,i,r,a){n(this,t),this._address=e,this.options=i||{},"boolean"==typeof r?(this._secure=r,this._handler=null):(this._secure=a||!1,this._handler=r),this._protocol="http",this._listenerMap={}}return r(t,[{key:"getAddress",value:function(){return this.getProtocol()+"://"+this._address.replace(/^(\w+:\/\/)?/,"")}},{key:"getProtocol",value:function(){return this._protocol+(this._secure?"s":"")}},{key:"request",value:function(t,e){}},{key:"send",value:function(t,e){this.request(t,e)}},{key:"close",value:function(){}},{key:"on",value:function(t,e){if("function"==typeof e){var i=this._listenerMap[t]||(this._listenerMap[t]=[]);i.indexOf(e)<0&&i.push(e)}return this}},{key:"off",value:function(t,e){if("function"==typeof e){var i=this._listenerMap[t]||(this._listenerMap[t]=[]),n=i.indexOf(e);n>=0&&i.splice(n,1)}return this}},{key:"trigger",value:function(t){for(var e=this,i=arguments.length,n=Array(i>1?i-1:0),r=1;i>r;r++)n[r-1]=arguments[r];var a=this._listenerMap[t];return a&&a.forEach(function(t){return t.apply(e,n)}),this._handler&&"function"==typeof this._handler[t]&&this._handler[t].apply(this._handler,n),this}}]),t}();a.EVENT_OPEN="open",a.EVENT_CLOSE="close",a.EVENT_ERROR="error",a.EVENT_REQUEST="request",a.EVENT_SEND="send",a.EVENT_RESPONSE="response",a.EVENT_MESSAGE="message",a.EVENT_PROGRESS="progress",i["default"]=a,e.exports=i["default"]},{}],10:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(t,e,i){for(var n=!0;n;){var r=t,a=e,o=i;s=h=u=void 0,n=!1;var s=Object.getOwnPropertyDescriptor(r,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var h=Object.getPrototypeOf(r);if(null===h)return;t=h,e=a,i=o,n=!0}},u=t("./connection"),h=n(u),c=t("./BaseConnection"),l=n(c),f=t("./util"),d=t("./ajax"),p=n(d),v=function(t){function e(){for(var t=arguments.length,i=Array(t),n=0;t>n;n++)i[n]=arguments[n];r(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,i),this._request=[]}return a(e,t),o(e,[{key:"request",value:function(t,e){var i=this;e=(0,f.extend)({},this.options,e),e.success=function(t,e,n){i.trigger(l["default"].EVENT_MESSAGE,t),i.trigger(l["default"].EVENT_RESPONSE,t)},e.error=function(t,e,n){i.trigger(l["default"].EVENT_ERROR,n)},e.complete=function(){var t=i._request.indexOf(n);i._request.splice(t,1)},e.url=this.getAddress()+(t?t:"");var n=(0,p["default"])(e);return n&&(n.onreadystatechange=function(t){return function(){2===n.readyState&&(i.trigger(l["default"].EVENT_SEND),i.trigger(l["default"].EVENT_REQUEST)),t&&t()}}(n.onreadystatechange)),this.trigger(l["default"].EVENT_OPEN),this._request.push(n),n.onprogress=function(t){i.trigger(l["default"].EVENT_PROGRESS,t)},this}},{key:"close",value:function(){var t=this;return this._request.forEach(function(e,i){e.abort(),t._request.splice(i,1)}),this.trigger(l["default"].EVENT_CLOSE),this}}]),e}(l["default"]);i["default"]=v,h["default"].http=function(t,e,i){return new v(t,e,i,!1)},h["default"].https=function(t,e,i){return new v(t,e,i,!0)},e.exports=i["default"]},{"./BaseConnection":9,"./ajax":14,"./connection":15,"./util":16}],11:[function(t,e,i){"use strict";if("undefined"!=typeof window)window.WebSocket?e.exports=window.WebSocket:console.log("当前浏览器不支持WebSocket");else{var n="ws";e.exports=t(n)}},{}],12:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=function(t,e,i){for(var n=!0;n;){var r=t,a=e,o=i;s=h=u=void 0,n=!1;var s=Object.getOwnPropertyDescriptor(r,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(o)}var h=Object.getPrototypeOf(r);if(null===h)return;t=h,e=a,i=o,n=!0}},u=t("./connection"),h=n(u),c=t("./BaseConnection"),l=n(c),f=t("./WebSocket"),d=n(f),p=function(t){function e(t,i,n){r(this,e),s(Object.getPrototypeOf(e.prototype),"constructor",this).apply(this,arguments),this._protocol="ws",this._ws=null;var a=i&&i.deferred===!0||!1;a===!1&&this._connect()}return a(e,t),o(e,[{key:"getStatus",value:function(){return this._ws?this._ws.readyState:d["default"].CLOSED}},{key:"_connect",value:function(){var t=this;if("undefined"==typeof d["default"])throw Error("Don't support WebSocket");this._ws=new d["default"](this.getAddress()),void 0===d["default"].OPEN&&(d["default"].CONNECTING=this._ws.CONNECTING,d["default"].OPEN=this._ws.OPEN,d["default"].CLOSING=this._ws.CLOSING,d["default"].CLOSED=this._ws.CLOSED),this._ws.binaryType=this.options.binaryType||this.options.dataType||"arraybuffer",this._ws.addEventListener("open",function(){t.trigger(l["default"].EVENT_OPEN)}),this._ws.addEventListener("error",function(){t.trigger(l["default"].EVENT_ERROR)}),this._ws.addEventListener("close",function(){t.trigger(l["default"].EVENT_CLOSE)}),this._ws.addEventListener("message",function(e){t.trigger(l["default"].EVENT_MESSAGE,e.data),t.trigger(l["default"].EVENT_RESPONSE,e.data)})}},{key:"request",value:function(t,e){var i=this;return t=t||"",this.getStatus()===d["default"].CLOSED&&this._connect(),this.getStatus()!==d["default"].OPEN?this._ws.addEventListener("open",function(){i._ws.send(t),i.trigger(l["default"].EVENT_SEND,t),i.trigger(l["default"].EVENT_REQUEST,t)}):(this._ws.send(t),this.trigger(l["default"].EVENT_SEND,t),this.trigger(l["default"].EVENT_REQUEST,t)),this}},{key:"close",value:function(){return this.getStatus()!==d["default"].CLOSED&&(this._ws.close(),this._ws=null),this}}]),e}(l["default"]);i["default"]=p,h["default"].ws=function(t,e,i){return new p(t,e,i,!1)},h["default"].wss=function(t,e,i){return new p(t,e,i,!0)},e.exports=i["default"]},{"./BaseConnection":9,"./WebSocket":11,"./connection":15}],13:[function(t,e,i){"use strict";if("undefined"!=typeof window)window.XMLHttpRequest?e.exports=window.XMLHttpRequest:console.log("当前浏览器不支持XMLHttpRequest");else{var n="xhr2",r=t(n);e.exports=r.XMLHttpRequest||r}},{}],14:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function r(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0})}function a(t){if("undefined"==typeof ArrayBuffer)throw new Error("不支持ArrayBuffer类型");if(t.response instanceof ArrayBuffer)return t.response;for(var e=t.responseText,i=e.length,n=new ArrayBuffer(i),r=new Uint8Array(n),a=0;i>a;a++)r[a]=255&e.charCodeAt(a);return n}function o(t){if("undefined"==typeof Blob)throw new Error("不支持Blob类型");if(t.response instanceof Blob)return t.response;var e=a(t);return new Blob([e])}var s=t("./XMLHttpRequest"),u=n(s),h=t("./util");if("undefined"!=typeof $&&"function"==typeof $.ajax){var c=function(t,e,i){return{send:function(e,i){var n,s,u,h;h=t.xhr(),u=t.url,s=t.type,n=t.data||null,h.onload=function(){var e="arraybuffer"===t.dataType?a(h):o(h),n=r({},t.dataType,e);return i(h.status,h.statusText,n,h.getAllResponseHeaders())},h.onerror="error",function(t){return i(-1,t)},h.ontimeout=function(t){return i(-1,t)},h.open(s,u,!0);var c="string"==typeof h.responseType;c?h.responseType=t.dataType:h.overrideMimeType?h.overrideMimeType("text/plain; charset=x-user-defined"):h.setRequestHeader("Accept-Charset","x-user-defined");for(var l in e)h.setRequestHeader(l,e[l]);return h.send(n)},abort:function(){return i.abort()}}},l=$.ajaxSettings.xhr;$.support.cors=!0,$.ajaxSetup({xhr:function E(){var E=l();return this.setXHR(E),E},beforeSend:function(t,e){e.setXHR=function(e){e.abort=t.abort,t.xhr=e}},crossDomain:!0}),$.ajaxTransport("+arraybuffer",c),$.ajaxTransport("+blob",c),e.exports=function(){var t=$.ajax.apply($,[].slice.call(arguments));return t.xhr}}else{var f,d,p,v,g,m,y,b,x,w,C,_;!function(){var t=function(t,e,i){return!0},i=function(e,i,n,r){return e.global?t(i||p,n,r):void 0},n=function(t){t.global&&0===_.active++&&i(t,null,"ajaxStart")},r=function(t){t.global&&!--_.active&&i(t,null,"ajaxStop")},s=function(t,e){var n=e.context;return e.beforeSend.call(n,t,e)===!1||i(e,n,"ajaxBeforeSend",[t,e])===!1?!1:void i(e,n,"ajaxSend",[t,e])},c=function(t,e,n){var r=n.context,a="success";n.success.call(r,t,a,e),i(n,r,"ajaxSuccess",[e,n,t]),E(a,e,n)},l=function(t,e,n,r){var a=r.context;r.error.call(a,n,e,t),i(r,a,"ajaxError",[n,r,t]),E(e,n,r)},E=function(t,e,n){var a=n.context;n.complete.call(a,e,t),i(n,a,"ajaxComplete",[e,n]),r(n)},T=function(){},P=function(t){return t&&(t==w?"html":t==x?"json":y.test(t)?"script":b.test(t)&&"xml")||"text"},S=function(t,e){return(t+"&"+e).replace(/[&?]{1,2}/,"?")},k=function(t){"object"==typeof t.data&&(t.data=(0,h.param)(t.data)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=S(t.url,t.data))};f=0,d="undefined"==typeof window,p=!d&&window.document,m=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,y=/^(?:text|application)\/javascript/i,b=/^(?:text|application)\/xml/i,x="application/json",w="text/html",C=/^\s*$/,_=e.exports=function(t){var e=(0,h.extend)({},t||{});for(v in _.settings)void 0===e[v]&&(e[v]=_.settings[v]);n(e),e.crossDomain||(e.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(e.url)&&!d&&!!window.location&&RegExp.$2!=window.location.host);var i=e.dataType,r=/=\?/.test(e.url);if("jsonp"==i||r)return r||(e.url=S(e.url,"callback=?")),_.JSONP(e);e.url||(e.url=!d&&!!window.location&&window.location.toString()),k(e);var u,f=e.accepts[i],p={},m=/^([\w-]+:)\/\//.test(e.url)?RegExp.$1:!d&&!!window.location&&window.location.protocol,y=_.settings.xhr();e.crossDomain||(p["X-Requested-With"]="XMLHttpRequest"),f&&(p.Accept=f,f.indexOf(",")>-1&&(f=f.split(",",2)[0]),y.overrideMimeType&&y.overrideMimeType(f)),(e.contentType||e.data&&"GET"!=e.type.toUpperCase())&&(p["Content-Type"]=e.contentType||"application/x-www-form-urlencoded"),e.headers=(0,h.extend)(p,e.headers||{}),y.onreadystatechange=function(){if(4==y.readyState){clearTimeout(u);var t,n=!1;if(y.status>=200&&y.status<300||304==y.status||0==y.status&&"file:"==m){
i=i||P(y.getResponseHeader("content-type"));try{"script"==i?(1,eval)(t):t="xml"==i?y.responseXML:"json"==i?C.test(y.responseText)?null:JSON.parse(y.responseText):"arraybuffer"===i?a(y):"blob"===i?o(y):y.responseText}catch(r){n=r}n?l(n,"parsererror",y,e):c(t,y,e)}else l(null,"error",y,e)}};var b="async"in e?e.async:!0;if(y.open(e.type,e.url,b),"arraybuffer"==i||"blob"==i){var x="string"==typeof y.responseType;x?y.responseType=t.dataType:y.overrideMimeType?y.overrideMimeType("text/plain; charset=x-user-defined"):y.setRequestHeader("Accept-Charset","x-user-defined")}for(g in e.headers)y.setRequestHeader(g,e.headers[g]);return s(y,e)===!1?(y.abort(),!1):(e.timeout>0&&(u=setTimeout(function(){y.onreadystatechange=T,y.abort(),l(null,"timeout",y,e)},e.timeout)),y.send(e.data?e.data:null),y)},_.active=0,_.JSONP=function(t){if(!("type"in t))return _(t);var e,i="jsonp"+ ++f,n=p.createElement("script"),r=function(){!d&&i in window&&(window[i]=T),E("abort",a,t)},a={abort:r},o=p.getElementsByTagName("head")[0]||p.documentElement;return t.error&&(n.onerror=function(){a.abort(),t.error()}),d||(window[i]=function(n){clearTimeout(e),delete window[i],c(n,a,t)}),k(t),n.src=t.url.replace(/=\?/,"="+i),o.insertBefore(n,o.firstChild),t.timeout>0&&(e=setTimeout(function(){a.abort(),E("timeout",a,t)},t.timeout)),a},_.settings={type:"GET",beforeSend:T,success:T,error:T,complete:T,context:null,global:!0,xhr:function(){return new u["default"]},accepts:{script:"text/javascript, application/javascript",json:x,xml:"application/xml, text/xml",html:w,text:"text/plain"},crossDomain:!1,timeout:0},_.get=function(t,e){return _({url:t,success:e})},_.post=function(t,e,i,n){return"function"==typeof e&&(n=n||i,i=e,e=null),_({type:"POST",url:t,data:e,success:i,dataType:n})},_.getJSON=function(t,e){return _({url:t,success:e,dataType:"json"})}}()}},{"./XMLHttpRequest":13,"./util":16}],15:[function(t,e,i){"use strict";function n(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t)){var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!e||i.length!==e);n=!0);}catch(u){r=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw a}}return i}throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(t,e,i){if("string"!=typeof t)throw new Error("url is incorrect");var a=/^((\w+):\/\/)?(.*)/.exec(t),o=n(a,4),s=o[2],u=void 0===s?"http":s,h=o[3],c=r[u];if(!c)throw new Error('protocol "'+u+'" no support');return c(h,e,i)}Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=r,e.exports=i["default"]},{}],16:[function(t,e,i){"use strict";function n(t,e,i,r){var a=e instanceof Array;for(var o in e){var s=e[o];r&&(o=i?r:r+"["+(a?"":o)+"]"),!r&&a?t.add(s.name,s.value):(i?s instanceof Array:"object"==typeof s)?n(t,s,i,o):t.add(o,s)}}function r(t,e){var i=[];return i.add=function(t,e){this.push(o(t)+"="+o(e))},n(i,t,e),i.join("&").replace("%20","+")}function a(t){var e=Array.prototype.slice;return e.call(arguments,1).forEach(function(e){for(var i in e)void 0!==e[i]&&(t[i]=e[i])}),t}Object.defineProperty(i,"__esModule",{value:!0}),i.serialize=n,i.param=r,i.extend=a;var o=encodeURIComponent},{}]},{},[6]);